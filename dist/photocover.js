var MouseType;!function(t){t[t.GRAFFITI=0]="GRAFFITI",t[t.ERASER=1]="ERASER",t[t.MOSAIC=2]="MOSAIC"}(MouseType||(MouseType={}));var PhotoCover=function(){function t(e){this.isMobile=navigator.userAgent.indexOf("iPhone")>-1||navigator.userAgent.indexOf("Android")>-1,this.win=window,this.doc=document,this.body=document.body,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.mouseType=MouseType.GRAFFITI,this.radius=t.DEFAULT_RADIUS,this.resolution=t.DEFAULT_RESOLUTION,this.maxWidth=t.DEFAULT_MAX_WIDTH,this.color=t.DEFAULT_COLOR,this.lineCap=t.DEFAULT_LINECAP,this.lineJoin=t.DEFAULT_LINEJOIN,this.histories=[],this.bindedEvents=[],this.historyChange=new CustomEvent("historyChange",{detail:this.histories}),"object"==typeof e?this.img=e:"string"==typeof e&&(this.img=document.querySelector(e)),this.canvas.width=this.img.width,this.canvas.height=this.img.height,this.init()}return t.prototype.init=function(){var t=this,e=[this.body,this.win,this.doc],i=e[0],s=e[1],o=e[2];this.async(),i.appendChild(this.canvas),this.isMobile||this.initMouse();var n=function(){t.async()}.bind(this);s.addEventListener("resize",n,!1),this.bindedEvents.push([s,"resize",n]),this.ctx.drawImage(this.img,0,0,this.canvas.width,this.canvas.height);var h,a,r,u=[],p=!1,d=function(e){a=e.pageX,r=e.pageY;var n=t.getCoordinateByEvent(e),d=n[0],l=n[1];u=[],t.isOnCanvas(e.pageX,e.pageY)&&(p=!0,t.mouseType===MouseType.GRAFFITI||t.mouseType===MouseType.ERASER?(t.ctx.beginPath(),u.push(["MOVE_TO",d,l]),u.push(t.drawByEvent(e)),t.ctx.beginPath(),u.push(["MOVE_TO",d,l])):t.mouseType===MouseType.MOSAIC&&(h=o.createElement("div"),h.style.cssText="\n            position: absolute;\n            left: "+a+"px;\n            top: "+r+"px;\n            width: 0;\n            height: 0;\n            border: 1px dashed #ddd;\n            background-color: rgba(125, 125, 125, 0.5)\n\n          ",i.appendChild(h)),s.addEventListener(t.isMobile?"touchmove":"mousemove",c,!1))}.bind(this),c=function(e){if(e.preventDefault(),t.mouseType===MouseType.GRAFFITI||t.mouseType===MouseType.ERASER)u.push(t.drawByEvent(e));else if(t.mouseType===MouseType.MOSAIC){var i=t.limitRect(t.caculateRect(a,r,e.pageX,e.pageY));h.style.left=i.left-1+"px",h.style.top=i.top-1+"px",h.style.width=i.width+"px",h.style.height=i.height+"px"}}.bind(this),l=function(e){if(e.preventDefault(),s.removeEventListener(t.isMobile?"touchmove":"mousemove",c,!1),p){if(p=!1,t.mouseType===MouseType.GRAFFITI||t.mouseType===MouseType.ERASER)t.histories.push(u),t.img.dispatchEvent(t.historyChange),u=[];else if(t.mouseType===MouseType.MOSAIC){var o=t.limitRect(t.caculateRect(a,r,e.pageX,e.pageY)),n=[o.left-t.canvas.offsetLeft,o.top-t.canvas.offsetTop],d=n[0],l=n[1];if(o.width>0&&o.height>0){var f=t.ctx.getImageData(d,l,o.width,o.height);t.ctx.putImageData(t.mosaic(f),d,l,0,0,o.width,o.height),t.histories.push([[MouseType.MOSAIC,d,l,o.width,o.height]]),t.img.dispatchEvent(t.historyChange)}i.removeChild(h)}t.mouseType===MouseType.ERASER&&t.combineWithBackground()}}.bind(this);s.addEventListener(this.isMobile?"touchstart":"mousedown",d,!1),this.bindedEvents.push([s,this.isMobile?"touchstart":"mousedown",d]),s.addEventListener(this.isMobile?"touchend":"mouseup",l,!1),this.bindedEvents.push([s,this.isMobile?"touchend":"mouseup",l])},t.prototype.async=function(){this.canvas.style.cssText="\n      position: absolute;\n      left: "+this.img.offsetLeft+"px;\n      top: "+this.img.offsetTop+"px;\n      use-select: none;\n    "},t.prototype.initMouse=function(){var t=this,e=[this.body,this.win],i=e[0],s=e[1],o=document.createElement("div");o.style.cssText="\n      display: none;\n      position: absolute;\n      left: 0;\n      top: 0;\n      z-index: 10001;\n      width: "+2*this.radius+"px;\n      height: "+2*this.radius+"px;\n      border: 1px solid red;\n      border-radius: 100%;\n    ",this.mouse=o,i.appendChild(o);var n=function(e){var s=[e.pageX,e.pageY],n=s[0],h=s[1],a=t.isOnCanvas(n,h);o.style.transform="translate("+(n-t.radius-1)+"px, "+(h-t.radius-1)+"px)",a?t.mouseType===MouseType.MOSAIC?(o.style.display="none",i.style.cursor="crosshair"):(o.style.display="block",i.style.cursor="none"):(o.style.display="none",i.style.cursor="default")}.bind(this);s.addEventListener(this.isMobile?"touchmove":"mousemove",n,!1),this.bindedEvents.push([s,this.isMobile?"touchmove":"mousemove",n])},t.prototype.setRadius=function(t){if(!(t<1||t>100)){this.radius=t;var e=this.mouse;e&&(e.style.width=2*t+"px",e.style.height=2*t+"px")}},t.prototype.setResolution=function(t){t<2||t>100||(this.resolution=t)},t.prototype.zoomIn=function(t){void 0===t&&(t=2),this.setRadius(this.radius+t)},t.prototype.zoomOut=function(t){void 0===t&&(t=2),this.setRadius(this.radius-t)},t.prototype.lineTo=function(t,e){var i=this.ctx;i.lineCap=this.lineCap,i.lineJoin="round",i.strokeStyle=this.color,i.lineWidth=2*this.radius,i.lineTo(t,e),i.stroke()},t.prototype.drawLine=function(t,e){return this.ctx.globalCompositeOperation="source-over",this.lineCap="round",this.lineJoin="round",this.lineTo(t,e),[MouseType.GRAFFITI,this.color,t,e,this.radius]},t.prototype.erase=function(t,e){return this.ctx.globalCompositeOperation="destination-out",this.lineCap="round",this.lineJoin="round",this.lineTo(t,e),this.ctx.globalCompositeOperation="source-over",[MouseType.ERASER,t,e,this.radius]},t.prototype.mosaic=function(t){var e=[this.doc][0],i={resolution:this.resolution},s=e.createElement("canvas"),o=s.getContext("2d");if(!o)return new ImageData(0,0);s.width=t.width,s.height=t.height,o.putImageData(t,0,0);for(var n,h,a,r,u=s.height/i.resolution,p=s.width/i.resolution,d=0;d<u;d++)for(var c=0;c<p;c++)n=t.data[4*(d*i.resolution*s.width+c*i.resolution)+0],h=t.data[4*(d*i.resolution*s.width+c*i.resolution)+1],a=t.data[4*(d*i.resolution*s.width+c*i.resolution)+2],r=t.data[4*(d*i.resolution*s.width+c*i.resolution)+3],o.fillStyle="rgba("+n+", "+h+", "+a+", "+r+")",o.fillRect(c*i.resolution,d*i.resolution,i.resolution,i.resolution);return o.getImageData(0,0,s.width,s.height)},t.prototype.drawByEvent=function(t){var e=this.getCoordinateByEvent(t),i=e[0],s=e[1];return this.mouseType===MouseType.GRAFFITI?this.drawLine(i,s):this.mouseType===MouseType.ERASER?this.erase(i,s):[]},t.prototype.getCoordinateByEvent=function(t){var e,i;return this.isMobile&&(t=t.changedTouches[0]),e=t.pageX-this.canvas.offsetLeft,i=t.pageY-this.canvas.offsetTop,[e,i]},t.prototype.limitRect=function(t){var e=JSON.parse(JSON.stringify(t));return t.left<this.canvas.offsetLeft&&(e.width=t.left+t.width-this.canvas.offsetLeft,e.left=this.canvas.offsetLeft),t.top<this.canvas.offsetTop&&(e.height=t.top+t.height-this.canvas.offsetTop,e.top=this.canvas.offsetTop),t.left+t.width>this.canvas.offsetLeft+this.canvas.clientWidth&&(e.width=this.canvas.offsetLeft+this.canvas.clientWidth-t.left),t.top+t.height>this.canvas.offsetTop+this.canvas.clientHeight&&(e.height=this.canvas.offsetTop+this.canvas.clientHeight-t.top),e},t.prototype.caculateRect=function(t,e,i,s){var o=[i-t,s-e],n=o[0],h=o[1];return{left:n<0?t-Math.abs(n):t,top:h<0?e-Math.abs(h):e,width:Math.abs(n),height:Math.abs(h)}},t.prototype.isOnCanvas=function(t,e){return!(t<this.img.offsetLeft||t>this.img.offsetLeft+this.img.width||e<this.img.offsetTop||e>this.img.offsetTop+this.img.height)},t.prototype.setMaxWidth=function(t){this.maxWidth=t},t.prototype.setColor=function(t){this.color=t},t.prototype.setTool=function(t){this.mouseType=t,t===MouseType.GRAFFITI?this.setGraffiti():t===MouseType.ERASER?this.setEraser():t=MouseType.MOSAIC},t.prototype.setGraffiti=function(){this.mouse&&Object.assign(this.mouse.style,{borderRadius:"100%",border:"1px solid "+t.DEFAULT_GRAFFITI_BORDER_COLOR}),this.mouseType=MouseType.GRAFFITI},t.prototype.setEraser=function(){this.mouse&&Object.assign(this.mouse.style,{borderRadius:"100%",border:"1px dashed "+t.DEFAULT_ERASER_BORDER_COLOR}),this.mouseType=MouseType.ERASER},t.prototype.setMosaic=function(){this.mouseType=MouseType.MOSAIC},t.prototype.undo=function(){var t=this,e=this.ctx,i=this.color;e.save(),e.drawImage(this.img,0,0,this.canvas.width,this.canvas.height),this.histories.pop(),this.img.dispatchEvent(this.historyChange),this.histories.map(function(i){i.map(function(i){if(i[0]===MouseType.GRAFFITI)t.color=i[1],t.setRadius(i[4]),t.drawLine(i[2],i[3]);else if(i[0]===MouseType.ERASER)t.setRadius(i[3]),t.erase(i[1],i[2]),t.combineWithBackground();else if("MOVE_TO"===i[0])e.beginPath(),e.moveTo.apply(e,i.slice(1));else if(i[0]===MouseType.MOSAIC){var s=t.ctx.getImageData(i[1],i[2],i[3],i[4]);t.ctx.putImageData(t.mosaic(s),i[1],i[2],0,0,i[3],i[4])}})}),this.color=i,e.restore()},t.prototype.getImageOriginSize=function(t,e){var i=new Image;i.onload=function(){var t=i.width,s=i.height;e&&e(t,s)},i.src=t},t.prototype.getDataURL=function(t,e,i){void 0===t&&(t="image/jpeg"),void 0===e&&(e=.8),this.combineWithBackground(function(s){i&&i(s.toDataURL(t,e))})},t.prototype.combineWithBackground=function(t){var e=this.doc,i=e.createElement("canvas");i.width=this.canvas.width,i.height=this.canvas.height;var s=i.getContext("2d");s&&(s.drawImage(this.img,0,0,i.width,i.height),s.drawImage(this.canvas,0,0,i.width,i.height),this.ctx.drawImage(i,0,0,this.canvas.width,this.canvas.height),t&&t(i,s))},t.prototype.destroy=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.mouse.parentNode&&this.mouse.parentNode.removeChild(this.mouse),this.img.src="",this.bindedEvents.forEach(function(t){t[0].removeEventListener(t[1],t[2],!1)})},t.DEFAULT_RADIUS=20,t.DEFAULT_RESOLUTION=8,t.DEFAULT_MAX_WIDTH=800,t.DEFAULT_COLOR="black",t.DEFAULT_GRAFFITI_BORDER_COLOR="red",t.DEFAULT_ERASER_BORDER_COLOR="#666",t.DEFAULT_LINECAP="round",t.DEFAULT_LINEJOIN="round",t}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBob3RvY292ZXIudHMiXSwibmFtZXMiOlsiTW91c2VUeXBlIiwiUGhvdG9Db3ZlciIsInNlbGVjdG9yIiwidGhpcyIsImlzTW9iaWxlIiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwiaW5kZXhPZiIsIndpbiIsIndpbmRvdyIsImRvYyIsImRvY3VtZW50IiwiYm9keSIsImNhbnZhcyIsImNyZWF0ZUVsZW1lbnQiLCJjdHgiLCJnZXRDb250ZXh0IiwibW91c2VUeXBlIiwiR1JBRkZJVEkiLCJyYWRpdXMiLCJERUZBVUxUX1JBRElVUyIsInJlc29sdXRpb24iLCJERUZBVUxUX1JFU09MVVRJT04iLCJtYXhXaWR0aCIsIkRFRkFVTFRfTUFYX1dJRFRIIiwiY29sb3IiLCJERUZBVUxUX0NPTE9SIiwibGluZUNhcCIsIkRFRkFVTFRfTElORUNBUCIsImxpbmVKb2luIiwiREVGQVVMVF9MSU5FSk9JTiIsImhpc3RvcmllcyIsImJpbmRlZEV2ZW50cyIsImhpc3RvcnlDaGFuZ2UiLCJDdXN0b21FdmVudCIsImRldGFpbCIsImltZyIsInF1ZXJ5U2VsZWN0b3IiLCJ3aWR0aCIsImhlaWdodCIsImluaXQiLCJwcm90b3R5cGUiLCJfdGhpcyIsIl9hIiwiYXN5bmMiLCJhcHBlbmRDaGlsZCIsImluaXRNb3VzZSIsInJlc2l6ZSIsImJpbmQiLCJhZGRFdmVudExpc3RlbmVyIiwicHVzaCIsImRyYXdJbWFnZSIsIm1vc2FpY1NlbGVjdGlvbiIsInN0YXJ0WCIsInN0YXJ0WSIsImN1cnJlbnRPcGVyYXRlIiwibW91c2VEb3duT25DYW52YXMiLCJjYW52YXNNb3VzZURvd24iLCJlIiwicGFnZVgiLCJwYWdlWSIsImdldENvb3JkaW5hdGVCeUV2ZW50IiwieCIsInkiLCJpc09uQ2FudmFzIiwiRVJBU0VSIiwiYmVnaW5QYXRoIiwiZHJhd0J5RXZlbnQiLCJNT1NBSUMiLCJzdHlsZSIsImNzc1RleHQiLCJjYW52YXNNb3VzZU1vdmUiLCJwcmV2ZW50RGVmYXVsdCIsInJlY3QiLCJsaW1pdFJlY3QiLCJjYWN1bGF0ZVJlY3QiLCJsZWZ0IiwidG9wIiwiY2FudmFzTW91c2VVcCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJkaXNwYXRjaEV2ZW50Iiwib2Zmc2V0TGVmdCIsIm9mZnNldFRvcCIsImltYWdlRGF0YSIsImdldEltYWdlRGF0YSIsInB1dEltYWdlRGF0YSIsIm1vc2FpYyIsInJlbW92ZUNoaWxkIiwiY29tYmluZVdpdGhCYWNrZ3JvdW5kIiwibW91c2UiLCJtb3VzZU1vdmUiLCJ0cmFuc2Zvcm0iLCJkaXNwbGF5IiwiY3Vyc29yIiwic2V0UmFkaXVzIiwic2V0UmVzb2x1dGlvbiIsInpvb21JbiIsInpvb21PdXQiLCJsaW5lVG8iLCJzdHJva2VTdHlsZSIsImxpbmVXaWR0aCIsInN0cm9rZSIsImRyYXdMaW5lIiwiZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uIiwiZXJhc2UiLCJvcHRpb25zIiwiSW1hZ2VEYXRhIiwiciIsImciLCJiIiwiYSIsInJvd3MiLCJjb2xzIiwicm93IiwiY29sIiwiZGF0YSIsImZpbGxTdHlsZSIsImZpbGxSZWN0IiwiZXZlbnQiLCJjaGFuZ2VkVG91Y2hlcyIsIm5ld1JlY3QiLCJKU09OIiwicGFyc2UiLCJzdHJpbmdpZnkiLCJjbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsImVuZFgiLCJlbmRZIiwidyIsImgiLCJNYXRoIiwiYWJzIiwic2V0TWF4V2lkdGgiLCJzZXRDb2xvciIsInNldFRvb2wiLCJ0b29sIiwic2V0R3JhZmZpdGkiLCJzZXRFcmFzZXIiLCJPYmplY3QiLCJhc3NpZ24iLCJib3JkZXJSYWRpdXMiLCJib3JkZXIiLCJERUZBVUxUX0dSQUZGSVRJX0JPUkRFUl9DT0xPUiIsIkRFRkFVTFRfRVJBU0VSX0JPUkRFUl9DT0xPUiIsInNldE1vc2FpYyIsInVuZG8iLCJzYXZlIiwicG9wIiwibWFwIiwic3RlcHMiLCJzdGVwIiwibW92ZVRvIiwiYXBwbHkiLCJzbGljZSIsInJlc3RvcmUiLCJnZXRJbWFnZU9yaWdpblNpemUiLCJzcmMiLCJjYWxsYmFjayIsIkltYWdlIiwib25sb2FkIiwiZ2V0RGF0YVVSTCIsInR5cGUiLCJxdWFsaXR5IiwidG9EYXRhVVJMIiwiZGVzdHJveSIsInBhcmVudE5vZGUiLCJmb3JFYWNoIiwidiJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBS0EsWUFBTCxTQUFLQSxHQUFZQSxFQUFBQSxFQUFBLFNBQUEsR0FBQSxXQUFVQSxFQUFBQSxFQUFBLE9BQUEsR0FBQSxTQUFRQSxFQUFBQSxFQUFBLE9BQUEsR0FBQSxVQUE5QkEsWUFBQUEsY0FTTCxJQUFBQyxZQUFBLFdBb0NFLFFBQUFBLEdBQVlDLEdBMUJIQyxLQUFBQyxTQUFXQyxVQUFVQyxVQUFVQyxRQUFRLFdBQWEsR0FBS0YsVUFBVUMsVUFBVUMsUUFBUSxZQUFjLEVBRzVHSixLQUFBSyxJQUFjQyxPQUNkTixLQUFBTyxJQUFvQkMsU0FDcEJSLEtBQUFTLEtBQW9CRCxTQUFTQyxLQUc3QlQsS0FBQVUsT0FBNEJGLFNBQVNHLGNBQWMsVUFHbkRYLEtBQUFZLElBQWdDWixLQUFLVSxPQUFPRyxXQUFXLE1BR3ZEYixLQUFBYyxVQUF1QmpCLFVBQVVrQixTQUNqQ2YsS0FBQWdCLE9BQVVsQixFQUFXbUIsZUFDckJqQixLQUFBa0IsV0FBYXBCLEVBQVdxQixtQkFDeEJuQixLQUFBb0IsU0FBV3RCLEVBQVd1QixrQkFDdEJyQixLQUFBc0IsTUFBUXhCLEVBQVd5QixjQUNuQnZCLEtBQUF3QixRQUFVMUIsRUFBVzJCLGdCQUNyQnpCLEtBQUEwQixTQUFXNUIsRUFBVzZCLGlCQUV0QjNCLEtBQUE0QixhQUNBNUIsS0FBQTZCLGdCQUNBN0IsS0FBQThCLGNBQXVCLEdBQUlDLGFBQVksaUJBQW1CQyxPQUFRaEMsS0FBSzRCLFlBSTdDLGdCQUFiN0IsR0FBeUJDLEtBQUtpQyxJQUFNbEMsRUFDbEIsZ0JBQWJBLEtBQXlCQyxLQUFLaUMsSUFBTXpCLFNBQVMwQixjQUFjbkMsSUFHM0VDLEtBQUtVLE9BQU95QixNQUFRbkMsS0FBS2lDLElBQUlFLE1BQzdCbkMsS0FBS1Us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QU8wQixNQUU1QixJQUFJeEIsR0FBTUYsRUFBT0csV0FBVyxLQUV2QkQsS0FFTEEsRUFBSW9DLFVBQVVoRCxLQUFLaUMsSUFBSyxFQUFHLEVBQUd2QixFQUFPeUIsTUFBT3pCLEVBQU8wQixRQUNuRHhCLEVBQUlvQyxVQUFVaEQsS0FBS1UsT0FBUSxFQUFHLEVBQUdBLEVBQU95QixNQUFPekIsRUFBTzBCLFFBRXREcEMsS0FBS1ksSUFBSW9DLFVBQVV0QyxFQUFRLEVBQUcsRUFBR1YsS0FBS1UsT0FBT3lCLE1BQU9uQyxLQUFLVSxPQUFPMEIsUUFDaEVzSCxHQUFZQSxFQUFTaEosRUFBUUUsS0FPL0JkLEVBQUF3QyxVQUFBMkgsUUFBQSxXQUNFakssS0FBS1UsT0FBT3dKLFlBQWNsSyxLQUFLVSxPQUFPd0osV0FBVzlFLFlBQVlwRixLQUFLVSxRQUNsRVYsS0FBS3NGLE1BQU00RSxZQUFjbEssS0FBS3NGLE1BQU00RSxXQUFXOUUsWUFBWXBGLEtBQUtzRixPQUVoRXRGLEtBQUtpQyxJQUFJd0gsSUFBTSxHQUVmekosS0FBSzZCLGFBQWFzSSxRQUFRLFNBQUFDLEdBQ3hCQSxFQUFFLEdBQUd4RixvQkFBb0J3RixFQUFFLEdBQUlBLEVBQUUsSUFBSSxNQWppQmxDdEssRUFBQW1CLGVBQXdCLEdBQ3hCbkIsRUFBQXFCLG1CQUE0QixFQUM1QnJCLEVBQUF1QixrQkFBMkIsSUFDM0J2QixFQUFBeUIsY0FBd0IsUUFDeEJ6QixFQUFBNkksOEJBQXdDLE1BQ3hDN0ksRUFBQThJLDRCQUFxQyxPQUNyQzlJLEVBQUEyQixnQkFBMEIsUUFDMUIzQixFQUFBNkIsaUJBQTJCLFFBOGhCcEM3QiIsImZpbGUiOiJwaG90b2NvdmVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZW51bSBNb3VzZVR5cGUgeyBHUkFGRklUSSwgRVJBU0VSLCBNT1NBSUMgfVxyXG5cclxuaW50ZXJmYWNlIFJlY3Qge1xyXG4gIGxlZnQ6IG51bWJlcjtcclxuICB0b3A6IG51bWJlcjtcclxuICB3aWR0aDogbnVtYmVyO1xyXG4gIGhlaWdodDogbnVtYmVyO1xyXG59XHJcblxyXG5jbGFzcyBQaG90b0NvdmVyIHtcclxuICBzdGF0aWMgREVGQVVMVF9SQURJVVM6bnVtYmVyID0gMjBcclxuICBzdGF0aWMgREVGQVVMVF9SRVNPTFVUSU9OOm51bWJlciA9IDhcclxuICBzdGF0aWMgREVGQVVMVF9NQVhfV0lEVEg6bnVtYmVyID0gODAwXHJcbiAgc3RhdGljIERFRkFVTFRfQ09MT1I6IHN0cmluZyA9ICdibGFjaydcclxuICBzdGF0aWMgREVGQVVMVF9HUkFGRklUSV9CT1JERVJfQ09MT1I6IHN0cmluZyA9ICdyZWQnXHJcbiAgc3RhdGljIERFRkFVTFRfRVJBU0VSX0JPUkRFUl9DT0xPUjpzdHJpbmcgPSAnIzY2NidcclxuICBzdGF0aWMgREVGQVVMVF9MSU5FQ0FQOiBzdHJpbmcgPSAncm91bmQnXHJcbiAgc3RhdGljIERFRkFVTFRfTElORUpPSU46IHN0cmluZyA9ICdyb3VuZCdcclxuXHJcbiAgcmVhZG9ubHkgaXNNb2JpbGUgPSBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ2lQaG9uZScpID4gLTEgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCdBbmRyb2lkJykgPiAtMVxyXG5cclxuICAvLyBjYWNoZSB3aW5kb3csIGRvY3VtZW50IGFuZCBib2R5IGZvciBzcGVlZCB1cCBwZXJmb3JtYW5jZVxyXG4gIHdpbjogV2luZG93ID0gd2luZG93XHJcbiAgZG9jOiBIVE1MRG9jdW1lbnQgPSBkb2N1bWVudFxyXG4gIGJvZHk6IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQuYm9keVxyXG5cclxuICBtb3VzZTogSFRNTERpdkVsZW1lbnQgICAvLyBtb3VzZSBwb2ludGVyIG9uIGNhbnZhc1xyXG4gIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKVxyXG4gIGltZzogSFRNTEltYWdlRWxlbWVudCAgLy8gaW1hZ2UgdGhhdCB5b3Ugd2FudCB0byBjaGFuZ2UgXHJcblxyXG4gIGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKSBhcyBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkRcclxuXHJcbiAgLy8gaW5pdCB2YWx1ZVxyXG4gIG1vdXNlVHlwZTogTW91c2VUeXBlID0gTW91c2VUeXBlLkdSQUZGSVRJLy8gZGVmYXVsdCBtb3VzZSBwb2ludGVyXHJcbiAgcmFkaXVzID0gIFBob3RvQ292ZXIuREVGQVVMVF9SQURJVVMgICAgLy8gZGVmYXVsdCByYWRpdXMgb2YgZ3JhZmZpdGlcclxuICByZXNvbHV0aW9uID0gUGhvdG9Db3Zlci5ERUZBVUxUX1JFU09MVVRJT04gICAvLyBkZWZhdWx0IHJlc29sdXRpb24gb2YgbW9zYWljXHJcbiAgbWF4V2lkdGggPSBQaG90b0NvdmVyLkRFRkFVTFRfTUFYX1dJRFRIICAgICAvLyBkZWZhdWx0IG1heCB3aWR0aCBvZiBpbWFnZVxyXG4gIGNvbG9yID0gUGhvdG9Db3Zlci5ERUZBVUxUX0NPTE9SICAgIC8vIGRlZmF1bHQgY29sb3Igb2YgY2FudmFzXHJcbiAgbGluZUNhcCA9IFBob3RvQ292ZXIuREVGQVVMVF9MSU5FQ0FQICAgIC8vIGRlZmF1bHQgbGluZWNhcCBvZiBsaW5lIG9uIGNhbnZhc1xyXG4gIGxpbmVKb2luID0gUGhvdG9Db3Zlci5ERUZBVUxUX0xJTkVKT0lOIC8vIGRlZmF1bHQgbGluZUpvaW4gb2YgbGluZSBvbiBjYW52YXNcclxuXHJcbiAgaGlzdG9yaWVzOiBhbnlbXVtdID0gW10gICAgLy8gb3BlcmF0ZSBoaXN0b3J5XHJcbiAgYmluZGVkRXZlbnRzOiBhbnlbXVtdID0gW10gICAgLy8gcmVnaXN0ZXJlZCBldmVudHMgW25vZGUsIHR5cGUsIGZ1bmN0aW9uXVxyXG4gIGhpc3RvcnlDaGFuZ2U6IEV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdoaXN0b3J5Q2hhbmdlJywgeyBkZXRhaWw6IHRoaXMuaGlzdG9yaWVzIH0pXHJcblxyXG4gIGNvbnN0cnVjdG9yKHNlbGVjdG9yOiBIVE1MSW1hZ2VFbGVtZW50IHwgc3RyaW5nKSB7XHJcblxyXG4gICAgaWYgKHR5cGVvZiBzZWxlY3RvciA9PT0gJ29iamVjdCcpIHsgdGhpcy5pbWcgPSBzZWxlY3RvciB9XHJcbiAgICBlbHNlIGlmICh0eXBlb2Ygc2VsZWN0b3IgPT09ICdzdHJpbmcnKSB7IHRoaXMuaW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcikgYXMgSFRNTEltYWdlRWxlbWVudCB9XHJcbiAgICBcclxuICAgIC8vIGluaXRpYWwgY2FudmFzIGFuZCBpdHMgc2l6ZSBhbmQgcG9zaXRpb25cclxuICAgIHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy5pbWcud2lkdGhcclxuICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMuaW1nLmhlaWdodFxyXG5cclxuICAgIHRoaXMuaW5pdCgpXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGluaXQoKTogdm9pZCB7XHJcblxyXG4gICAgbGV0IFtib2R5LCB3aW4sIGRvY10gPSBbdGhpcy5ib2R5LCB0aGlzLndpbiwgdGhpcy5kb2NdXHJcblxyXG4gICAgdGhpcy5hc3luYygpXHJcbiAgICBib2R5LmFwcGVuZENoaWxkKHRoaXMuY2FudmFzKVxyXG5cclxuICAgIGlmICghdGhpcy5pc01vYmlsZSkgeyB0aGlzLmluaXRNb3VzZSgpIH1cclxuXHJcbiAgICAvLyBhc3luYyBjYW52YXMgcG9zaXRpb24gYW5kIHNpemUgZHVyaW5nIGJyb3dzZXIgcmVzaXplXHJcbiAgICBsZXQgcmVzaXplID0gKCgpID0+IHtcclxuICAgICAgdGhpcy5hc3luYygpXHJcbiAgICB9KS5iaW5kKHRoaXMpXHJcbiAgICB3aW4uYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgcmVzaXplLCBmYWxzZSlcclxuICAgIHRoaXMuYmluZGVkRXZlbnRzLnB1c2goW3dpbiwgJ3Jlc2l6ZScsIHJlc2l6ZV0pXHJcblxyXG5cclxuICAgIC8vIHRoaXMuaW1nLnN0eWxlLmNzc1RleHQgPSBgb3BhY2l0eTogMC40YFxyXG4gICAgLy8gdGhpcy5pbWcuc3R5bGUub3BhY2l0eSA9ICcwJ1xyXG4gICAgdGhpcy5jdHguZHJhd0ltYWdlKHRoaXMuaW1nLCAwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KVxyXG5cclxuICAgIGxldCBjdXJyZW50T3BlcmF0ZTogYW55W11bXSA9IFtdXHJcblxyXG4gICAgbGV0IG1vdXNlRG93bk9uQ2FudmFzOiBib29sZWFuID0gZmFsc2VcclxuICAgIGxldCBtb3NhaWNTZWxlY3Rpb246IEhUTUxEaXZFbGVtZW50XHJcbiAgICBsZXQgc3RhcnRYOiBudW1iZXJcclxuICAgIGxldCBzdGFydFk6IG51bWJlclxyXG5cclxuICAgIGxldCBjYW52YXNNb3VzZURvd24gPSAoKGU6IGFueSkgPT4ge1xyXG4gICAgICAvLyBlLnByZXZlbnREZWZhdWx0KCkgICAgLy8gcHJldmVudERlZmF1bHQgd291bGQgYXZvaWQgaW5wdXQgcmFuZ2UgY2xpY2tcclxuXHJcbiAgICAgIHN0YXJ0WCA9IGUucGFnZVhcclxuICAgICAgc3RhcnRZID0gZS5wYWdlWVxyXG4gICAgICBjb25zdCBbeCwgeV0gPSB0aGlzLmdldENvb3JkaW5hdGVCeUV2ZW50KGUpXHJcblxyXG4gICAgICBjdXJyZW50T3BlcmF0ZSA9IFtdXHJcblxyXG4gICAgICBpZiAodGhpcy5pc09uQ2FudmFzKGUucGFnZVgsIGUucGFnZVkpKSB7XHJcbiAgICAgICAgbW91c2VEb3duT25DYW52YXMgPSB0cnVlXHJcblxyXG4gICAgICAgIGlmICh0aGlzLm1vdXNlVHlwZSA9PT0gTW91c2VUeXBlLkdSQUZGSVRJfHwgdGhpcy5tb3VzZVR5cGUgPT09IE1vdXNlVHlwZS5FUkFTRVIpIHtcclxuICAgICAgICAgIHRoaXMuY3R4LmJlZ2luUGF0aCgpXHJcbiAgICAgICAgICBjdXJyZW50T3BlcmF0ZS5wdXNoKFsnTU9WRV9UTycsIHgsIHldKVxyXG4gICAgICAgICAgY3VycmVudE9wZXJhdGUucHVzaCh0aGlzLmRyYXdCeUV2ZW50KGUpKVxyXG5cclxuICAgICAgICAgIHRoaXMuY3R4LmJlZ2luUGF0aCgpXHJcbiAgICAgICAgICBjdXJyZW50T3BlcmF0ZS5wdXNoKFsnTU9WRV9UTycsIHgsIHldKVxyXG5cclxuXHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1vdXNlVHlwZSA9PT0gTW91c2VUeXBlLk1PU0FJQykge1xyXG4gICAgICAgICAgbW9zYWljU2VsZWN0aW9uID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2RpdicpXHJcbiAgICAgICAgICBtb3NhaWNTZWxlY3Rpb24uc3R5bGUuY3NzVGV4dCA9IGBcclxuICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgICAgICAgICBsZWZ0OiAke3N0YXJ0WH1weDtcclxuICAgICAgICAgICAgdG9wOiAke3N0YXJ0WX1weDtcclxuICAgICAgICAgICAgd2lkdGg6IDA7XHJcbiAgICAgICAgICAgIGhlaWdodDogMDtcclxuICAgICAgICAgICAgYm9yZGVyOiAxcHggZGFzaGVkICNkZGQ7XHJcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMTI1LCAxMjUsIDEyNSwgMC41KVxyXG5cclxuICAgICAgICAgIGBcclxuICAgICAgICAgIGJvZHkuYXBwZW5kQ2hpbGQobW9zYWljU2VsZWN0aW9uKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgd2luLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5pc01vYmlsZSA/ICd0b3VjaG1vdmUnIDogJ21vdXNlbW92ZScsIGNhbnZhc01vdXNlTW92ZSwgZmFsc2UpXHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICB9KS5iaW5kKHRoaXMpXHJcblxyXG4gICAgbGV0IGNhbnZhc01vdXNlTW92ZSA9ICgoZTogYW55KSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKVxyXG4gICAgICBpZiAodGhpcy5tb3VzZVR5cGUgPT09IE1vdXNlVHlwZS5HUkFGRklUSSB8fCB0aGlzLm1vdXNlVHlwZSA9PT0gTW91c2VUeXBlLkVSQVNFUikge1xyXG4gICAgICAgIGN1cnJlbnRPcGVyYXRlLnB1c2godGhpcy5kcmF3QnlFdmVudChlKSlcclxuICAgICAgfSBlbHNlIGlmICh0aGlzLm1vdXNlVHlwZSA9PT0gTW91c2VUeXBlLk1PU0FJQykge1xyXG4gICAgICAgIGxldCByZWN0ID0gdGhpcy5saW1pdFJlY3QodGhpcy5jYWN1bGF0ZVJlY3Qoc3RhcnRYLCBzdGFydFksIGUucGFnZVgsIGUucGFnZVkpKVxyXG5cclxuICAgICAgICBtb3NhaWNTZWxlY3Rpb24uc3R5bGUubGVmdCA9IHJlY3QubGVmdCAtIDEgKyAncHgnXHJcbiAgICAgICAgbW9zYWljU2VsZWN0aW9uLnN0eWxlLnRvcCA9IHJlY3QudG9wIC0gMSArICdweCdcclxuICAgICAgICBtb3NhaWNTZWxlY3Rpb24uc3R5bGUud2lkdGggPSByZWN0LndpZHRoICsgJ3B4J1xyXG4gICAgICAgIG1vc2FpY1NlbGVjdGlvbi5zdHlsZS5oZWlnaHQgPSByZWN0LmhlaWdodCArICdweCdcclxuICAgICAgfVxyXG4gICAgfSkuYmluZCh0aGlzKVxyXG5cclxuICAgIGxldCBjYW52YXNNb3VzZVVwID0gKChlOiBhbnkpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgIHdpbi5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuaXNNb2JpbGUgPyAndG91Y2htb3ZlJzogJ21vdXNlbW92ZScsIGNhbnZhc01vdXNlTW92ZSwgZmFsc2UpXHJcbiAgICAgIFxyXG4gICAgICBpZiAobW91c2VEb3duT25DYW52YXMpIHtcclxuICAgICAgICBtb3VzZURvd25PbkNhbnZhcyAgPSBmYWxzZVxyXG4gICAgICAgIGlmICh0aGlzLm1vdXNlVHlwZSA9PT0gTW91c2VUeXBlLkdSQUZGSVRJIHx8IHRoaXMubW91c2VUeXBlID09PSBNb3VzZVR5cGUuRVJBU0VSKSB7XHJcbiAgICAgICAgICB0aGlzLmhpc3Rvcmllcy5wdXNoKGN1cnJlbnRPcGVyYXRlKVxyXG4gICAgICAgICAgdGhpcy5pbWcuZGlzcGF0Y2hFdmVudCh0aGlzLmhpc3RvcnlDaGFuZ2UpXHJcbiAgICAgICAgICBjdXJyZW50T3BlcmF0ZSA9IFtdXHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1vdXNlVHlwZSA9PT0gTW91c2VUeXBlLk1PU0FJQykge1xyXG4gICAgICAgICAgbGV0IHJlY3QgPSB0aGlzLmxpbWl0UmVjdCh0aGlzLmNhY3VsYXRlUmVjdChzdGFydFgsIHN0YXJ0WSwgZS5wYWdlWCwgZS5wYWdlWSkpXHJcbiAgICAgICAgICBsZXQgW3gsIHldID0gW3JlY3QubGVmdCAtIHRoaXMuY2FudmFzLm9mZnNldExlZnQsIHJlY3QudG9wIC0gdGhpcy5jYW52YXMub2Zmc2V0VG9wXSAvLyBjb29kaW5hdGUgcmVsYXRpdmUgY2FudmFzXHJcblxyXG4gICAgICAgICAgaWYgKHJlY3Qud2lkdGggPiAwICYmIHJlY3QuaGVpZ2h0ID4gMCkge1xyXG4gICAgICAgICAgICBsZXQgaW1hZ2VEYXRhID0gdGhpcy5jdHguZ2V0SW1hZ2VEYXRhKHgsIHksIHJlY3Qud2lkdGgsIHJlY3QuaGVpZ2h0KVxyXG4gICAgICAgICAgICB0aGlzLmN0eC5wdXRJbWFnZURhdGEodGhpcy5tb3NhaWMoaW1hZ2VEYXRhKSwgeCwgeSwgMCwgMCwgcmVjdC53aWR0aCwgcmVjdC5oZWlnaHQpXHJcblxyXG4gICAgICAgICAgICB0aGlzLmhpc3Rvcmllcy5wdXNoKFtbTW91c2VUeXBlLk1PU0FJQywgeCwgeSwgcmVjdC53aWR0aCwgcmVjdC5oZWlnaHRdXSlcclxuICAgICAgICAgICAgdGhpcy5pbWcuZGlzcGF0Y2hFdmVudCh0aGlzLmhpc3RvcnlDaGFuZ2UpXHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgYm9keS5yZW1vdmVDaGlsZChtb3NhaWNTZWxlY3Rpb24pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5tb3VzZVR5cGUgPT09IE1vdXNlVHlwZS5FUkFTRVIpIHtcclxuICAgICAgICAgIHRoaXMuY29tYmluZVdpdGhCYWNrZ3JvdW5kKClcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pLmJpbmQodGhpcylcclxuXHJcbiAgICAvLyBjYW52YXMgZG93blxyXG4gICAgd2luLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5pc01vYmlsZSA/ICd0b3VjaHN0YXJ0JzogJ21vdXNlZG93bicsIGNhbnZhc01vdXNlRG93biwgZmFsc2UpXHJcbiAgICB0aGlzLmJpbmRlZEV2ZW50cy5wdXNoKFt3aW4sIHRoaXMuaXNNb2JpbGUgPyAndG91Y2hzdGFydCc6ICdtb3VzZWRvd24nLCBjYW52YXNNb3VzZURvd25dKVxyXG5cclxuICAgIHdpbi5hZGRFdmVudExpc3RlbmVyKHRoaXMuaXNNb2JpbGUgPyAndG91Y2hlbmQnOiAnbW91c2V1cCcsIGNhbnZhc01vdXNlVXAsIGZhbHNlKVxyXG4gICAgdGhpcy5iaW5kZWRFdmVudHMucHVzaChbd2luLCB0aGlzLmlzTW9iaWxlID8gJ3RvdWNoZW5kJzogJ21vdXNldXAnLCBjYW52YXNNb3VzZVVwXSlcclxuICB9XHJcblxyXG4gIC8vIGFzeW5jIHggYW5kIHkgZnJvbSBpbWFnZSB0byBjYW52YXNcclxuICBwcml2YXRlIGFzeW5jKCkge1xyXG4gICAgdGhpcy5jYW52YXMuc3R5bGUuY3NzVGV4dCA9IGBcclxuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgICBsZWZ0OiAke3RoaXMuaW1nLm9mZnNldExlZnR9cHg7XHJcbiAgICAgIHRvcDogJHt0aGlzLmltZy5vZmZzZXRUb3B9cHg7XHJcbiAgICAgIHVzZS1zZWxlY3Q6IG5vbmU7XHJcbiAgICBgXHJcbiAgfVxyXG5cclxuICAvLyBpbml0aWFsIG1vdXNlIHNoYXBlIHdoZXJlIG1vdXNlIG9uIGNhbnZhc1xyXG4gIHByaXZhdGUgaW5pdE1vdXNlKCkge1xyXG4gICAgbGV0IFtib2R5LCB3aW5dID0gW3RoaXMuYm9keSwgdGhpcy53aW5dXHJcbiAgICBsZXQgbW91c2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxyXG4gICAgbW91c2Uuc3R5bGUuY3NzVGV4dCA9IGBcclxuICAgICAgZGlzcGxheTogbm9uZTtcclxuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgICBsZWZ0OiAwO1xyXG4gICAgICB0b3A6IDA7XHJcbiAgICAgIHotaW5kZXg6IDEwMDAxO1xyXG4gICAgICB3aWR0aDogJHt0aGlzLnJhZGl1cyAqIDJ9cHg7XHJcbiAgICAgIGhlaWdodDogJHt0aGlzLnJhZGl1cyAqIDJ9cHg7XHJcbiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJlZDtcclxuICAgICAgYm9yZGVyLXJhZGl1czogMTAwJTtcclxuICAgIGBcclxuICAgIHRoaXMubW91c2UgPSBtb3VzZVxyXG5cclxuICAgIGJvZHkuYXBwZW5kQ2hpbGQobW91c2UpXHJcblxyXG4gICAgbGV0IG1vdXNlTW92ZSA9ICgoZTogYW55KSA9PiB7XHJcbiAgICAgIGxldCBbeCwgeV0gPSBbZS5wYWdlWCwgZS5wYWdlWV1cclxuICAgICAgbGV0IGlzT25DYW52YXMgPSB0aGlzLmlzT25DYW52YXMoeCwgeSlcclxuXHJcbiAgICAgIG1vdXNlLnN0eWxlLnRyYW5zZm9ybSA9IGB0cmFuc2xhdGUoJHt4IC0gdGhpcy5yYWRpdXMgLSAxfXB4LCAke3kgLSB0aGlzLnJhZGl1cyAtIDF9cHgpYCAvLyBtaW51cyBib3JkZXIgd2lkdGggb2YgbW91c2UgdHlwZVxyXG5cclxuICAgICAgaWYgKCFpc09uQ2FudmFzKSB7XHJcbiAgICAgICAgbW91c2Uuc3R5bGUuZGlzcGxheSA9ICdub25lJ1xyXG4gICAgICAgIGJvZHkuc3R5bGUuY3Vyc29yID0gJ2RlZmF1bHQnXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKHRoaXMubW91c2VUeXBlID09PSBNb3VzZVR5cGUuTU9TQUlDKSB7XHJcbiAgICAgICAgICBtb3VzZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXHJcbiAgICAgICAgICBib2R5LnN0eWxlLmN1cnNvciA9ICdjcm9zc2hhaXInXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIG1vdXNlLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snXHJcbiAgICAgICAgICBib2R5LnN0eWxlLmN1cnNvciA9ICdub25lJ1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSkuYmluZCh0aGlzKVxyXG5cclxuICAgIC8vIGNoYW5nZSBtb3VzZSBzdHlsZVxyXG4gICAgd2luLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5pc01vYmlsZSA/ICd0b3VjaG1vdmUnOiAnbW91c2Vtb3ZlJywgbW91c2VNb3ZlLCBmYWxzZSlcclxuICAgIHRoaXMuYmluZGVkRXZlbnRzLnB1c2goW3dpbiwgdGhpcy5pc01vYmlsZSA/ICd0b3VjaG1vdmUnOiAnbW91c2Vtb3ZlJywgbW91c2VNb3ZlXSlcclxuICB9XHJcblxyXG4gIHNldFJhZGl1cyhyYWRpdXM6IG51bWJlcikge1xyXG4gICAgaWYgKHJhZGl1cyA8IDEgfHwgcmFkaXVzID4gMTAwKSB7XHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMucmFkaXVzID0gcmFkaXVzXHJcblxyXG4gICAgbGV0IG1vdXNlID0gdGhpcy5tb3VzZVxyXG5cclxuICAgIGlmIChtb3VzZSkge1xyXG4gICAgICBtb3VzZS5zdHlsZS53aWR0aCA9IHJhZGl1cyAqIDIgKyAncHgnXHJcbiAgICAgIG1vdXNlLnN0eWxlLmhlaWdodCA9IHJhZGl1cyAqIDIgKyAncHgnXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRSZXNvbHV0aW9uKHJlc29sdXRpb246IG51bWJlcikge1xyXG4gICAgaWYgKHJlc29sdXRpb24gPCAyIHx8IHJlc29sdXRpb24gPiAxMDApIHtcclxuICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5yZXNvbHV0aW9uID0gcmVzb2x1dGlvbiBcclxuICB9XHJcblxyXG4gIHpvb21JbihyYWRpdXM6bnVtYmVyID0gMikge1xyXG4gICAgdGhpcy5zZXRSYWRpdXModGhpcy5yYWRpdXMgKyByYWRpdXMpXHJcbiAgfVxyXG5cclxuICB6b29tT3V0KHJhZGl1czpudW1iZXIgPSAyKSB7XHJcbiAgICB0aGlzLnNldFJhZGl1cyh0aGlzLnJhZGl1cyAtIHJhZGl1cylcclxuICB9XHJcblxyXG5cclxuICBsaW5lVG8oeDogbnVtYmVyLCB5OiBudW1iZXIpOiB2b2lkIHtcclxuICAgIGNvbnN0IGN0eCA9IHRoaXMuY3R4XHJcbiAgICBjdHgubGluZUNhcCA9IHRoaXMubGluZUNhcFxyXG4gICAgY3R4LmxpbmVKb2luID0gJ3JvdW5kJ1xyXG4gICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5jb2xvclxyXG4gICAgY3R4LmxpbmVXaWR0aCA9IHRoaXMucmFkaXVzICogMlxyXG4gICAgY3R4LmxpbmVUbyh4LCB5KVxyXG4gICAgY3R4LnN0cm9rZSgpXHJcbiAgfVxyXG5cclxuICBkcmF3TGluZSh4OiBudW1iZXIsIHk6IG51bWJlcik6IGFueVtdIHtcclxuICAgIHRoaXMuY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9ICdzb3VyY2Utb3ZlcidcclxuICAgIHRoaXMubGluZUNhcCA9ICdyb3VuZCdcclxuICAgIHRoaXMubGluZUpvaW4gPSAncm91bmQnXHJcbiAgICB0aGlzLmxpbmVUbyh4LCB5KVxyXG4gICAgcmV0dXJuIFtNb3VzZVR5cGUuR1JBRkZJVEksIHRoaXMuY29sb3IsIHgsIHksIHRoaXMucmFkaXVzXVxyXG4gIH1cclxuXHJcbiAgZXJhc2UoeDogbnVtYmVyLCB5OiBudW1iZXIpOiBhbnlbXSB7XHJcbiAgICB0aGlzLmN0eC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAnZGVzdGluYXRpb24tb3V0J1xyXG4gICAgdGhpcy5saW5lQ2FwID0gJ3JvdW5kJ1xyXG4gICAgdGhpcy5saW5lSm9pbiA9ICdyb3VuZCdcclxuICAgIHRoaXMubGluZVRvKHgsIHkpXHJcbiAgICB0aGlzLmN0eC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAnc291cmNlLW92ZXInXHJcbiAgICByZXR1cm4gW01vdXNlVHlwZS5FUkFTRVIsIHgsIHksIHRoaXMucmFkaXVzXVxyXG4gIH1cclxuXHJcbiAgbW9zYWljKGltYWdlRGF0YTogSW1hZ2VEYXRhKTogSW1hZ2VEYXRhIHtcclxuICAgIGNvbnN0IFtkb2NdID0gW3RoaXMuZG9jXVxyXG5cclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICAgIHJlc29sdXRpb246IHRoaXMucmVzb2x1dGlvblxyXG4gICAgfVxyXG5cclxuICAgIGxldCBjYW52YXMgPSBkb2MuY3JlYXRlRWxlbWVudCgnY2FudmFzJylcclxuICAgIGxldCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKVxyXG5cclxuICAgIGlmICghY3R4KSB7IHJldHVybiBuZXcgSW1hZ2VEYXRhKDAsIDApfVxyXG5cclxuICAgIGNhbnZhcy53aWR0aCA9IGltYWdlRGF0YS53aWR0aFxyXG4gICAgY2FudmFzLmhlaWdodCA9IGltYWdlRGF0YS5oZWlnaHRcclxuICAgIGN0eC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKVxyXG5cclxuICAgIGxldCByb3dzID0gY2FudmFzLmhlaWdodCAvIG9wdGlvbnMucmVzb2x1dGlvblxyXG4gICAgbGV0IGNvbHMgPSBjYW52YXMud2lkdGggLyBvcHRpb25zLnJlc29sdXRpb25cclxuICAgIGxldCByLCBnLCBiLCBhXHJcblxyXG4gICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgcm93czsgcm93KyspIHtcclxuICAgICAgZm9yIChsZXQgY29sID0gMDsgY29sIDwgY29sczsgY29sKyspIHtcclxuXHJcbiAgICAgICAgLy8gbGV0IHRlbXBEYXRhID0gY3R4LmdldEltYWdlRGF0YShjb2wgKiBvcHRpb25zLnJlc29sdXRpb24sIHJvdyAqIG9wdGlvbnMucmVzb2x1dGlvbiwgMSwgMSkuZGF0YVxyXG4gICAgICAgIC8vIHIgPSB0ZW1wRGF0YVswXVxyXG4gICAgICAgIC8vIGcgPSB0ZW1wRGF0YVsxXVxyXG4gICAgICAgIC8vIGcgPSB0ZW1wRGF0YVsyXVxyXG4gICAgICAgIC8vIGEgPSB0ZW1wZGF0YVszXSAvIDI1NVxyXG5cclxuICAgICAgICByID0gaW1hZ2VEYXRhLmRhdGFbKHJvdyAqIG9wdGlvbnMucmVzb2x1dGlvbiAqIGNhbnZhcy53aWR0aCArIGNvbCAqIG9wdGlvbnMucmVzb2x1dGlvbikgKiA0ICsgMF1cclxuICAgICAgICBnID0gaW1hZ2VEYXRhLmRhdGFbKHJvdyAqIG9wdGlvbnMucmVzb2x1dGlvbiAqIGNhbnZhcy53aWR0aCArIGNvbCAqIG9wdGlvbnMucmVzb2x1dGlvbikgKiA0ICsgMV1cclxuICAgICAgICBiID0gaW1hZ2VEYXRhLmRhdGFbKHJvdyAqIG9wdGlvbnMucmVzb2x1dGlvbiAqIGNhbnZhcy53aWR0aCArIGNvbCAqIG9wdGlvbnMucmVzb2x1dGlvbikgKiA0ICsgMl1cclxuICAgICAgICBhID0gaW1hZ2VEYXRhLmRhdGFbKHJvdyAqIG9wdGlvbnMucmVzb2x1dGlvbiAqIGNhbnZhcy53aWR0aCArIGNvbCAqIG9wdGlvbnMucmVzb2x1dGlvbikgKiA0ICsgM11cclxuXHJcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGByZ2JhKCR7cn0sICR7Z30sICR7Yn0sICR7YX0pYFxyXG4gICAgICAgIGN0eC5maWxsUmVjdChjb2wgKiBvcHRpb25zLnJlc29sdXRpb24sIHJvdyAqIG9wdGlvbnMucmVzb2x1dGlvbiwgb3B0aW9ucy5yZXNvbHV0aW9uLCBvcHRpb25zLnJlc29sdXRpb24pXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gY3R4LmdldEltYWdlRGF0YSgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpXHJcbiAgfVxyXG5cclxuICBkcmF3QnlFdmVudChldmVudDogYW55KTogYW55W10ge1xyXG4gICAgbGV0IFt4LCB5XSA9IHRoaXMuZ2V0Q29vcmRpbmF0ZUJ5RXZlbnQoZXZlbnQpXHJcblxyXG4gICAgaWYgKHRoaXMubW91c2VUeXBlID09PSBNb3VzZVR5cGUuR1JBRkZJVEkpIHsgcmV0dXJuIHRoaXMuZHJhd0xpbmUoeCwgeSkgfVxyXG4gICAgZWxzZSBpZiAodGhpcy5tb3VzZVR5cGUgPT09IE1vdXNlVHlwZS5FUkFTRVIpIHsgcmV0dXJuIHRoaXMuZXJhc2UoeCwgeSkgfVxyXG4gICAgZWxzZSB7IHJldHVybiBbXSB9XHJcbiAgfVxyXG5cclxuICBnZXRDb29yZGluYXRlQnlFdmVudChldmVudDogYW55KSB7XHJcbiAgICBsZXQgeCwgeVxyXG4gICAgaWYgKHRoaXMuaXNNb2JpbGUpIHsgZXZlbnQgPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXSB9XHJcblxyXG4gICAgeCA9IGV2ZW50LnBhZ2VYIC0gdGhpcy5jYW52YXMub2Zmc2V0TGVmdFxyXG4gICAgeSA9IGV2ZW50LnBhZ2VZIC0gdGhpcy5jYW52YXMub2Zmc2V0VG9wXHJcblxyXG4gICAgcmV0dXJuIFt4LCB5XVxyXG4gIH1cclxuXHJcbiAgbGltaXRSZWN0KHJlY3Q6IFJlY3QpOiBSZWN0IHtcclxuICAgIGxldCBuZXdSZWN0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyZWN0KSlcclxuXHJcbiAgICBpZiAocmVjdC5sZWZ0IDwgdGhpcy5jYW52YXMub2Zmc2V0TGVmdCkge1xyXG4gICAgICBuZXdSZWN0LndpZHRoID0gcmVjdC5sZWZ0ICsgcmVjdC53aWR0aCAtIHRoaXMuY2FudmFzLm9mZnNldExlZnRcclxuICAgICAgbmV3UmVjdC5sZWZ0ID0gdGhpcy5jYW52YXMub2Zmc2V0TGVmdFxyXG4gICAgfVxyXG5cclxuICAgIGlmIChyZWN0LnRvcCA8IHRoaXMuY2FudmFzLm9mZnNldFRvcCkge1xyXG4gICAgICBuZXdSZWN0LmhlaWdodCA9IHJlY3QudG9wICsgcmVjdC5oZWlnaHQgLSB0aGlzLmNhbnZhcy5vZmZzZXRUb3BcclxuICAgICAgbmV3UmVjdC50b3AgPSB0aGlzLmNhbnZhcy5vZmZzZXRUb3BcclxuICAgIH1cclxuXHJcbiAgICBpZiAocmVjdC5sZWZ0ICsgcmVjdC53aWR0aCA+IHRoaXMuY2FudmFzLm9mZnNldExlZnQgKyB0aGlzLmNhbnZhcy5jbGllbnRXaWR0aCkge1xyXG4gICAgICBuZXdSZWN0LndpZHRoID0gdGhpcy5jYW52YXMub2Zmc2V0TGVmdCArIHRoaXMuY2FudmFzLmNsaWVudFdpZHRoIC0gcmVjdC5sZWZ0XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHJlY3QudG9wICsgcmVjdC5oZWlnaHQgPiB0aGlzLmNhbnZhcy5vZmZzZXRUb3AgKyB0aGlzLmNhbnZhcy5jbGllbnRIZWlnaHQpIHtcclxuICAgICAgbmV3UmVjdC5oZWlnaHQgPSB0aGlzLmNhbnZhcy5vZmZzZXRUb3AgKyB0aGlzLmNhbnZhcy5jbGllbnRIZWlnaHQgLSByZWN0LnRvcFxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBuZXdSZWN0XHJcbiAgfVxyXG5cclxuICBjYWN1bGF0ZVJlY3Qoc3RhcnRYOiBudW1iZXIsIHN0YXJ0WTogbnVtYmVyLCBlbmRYOiBudW1iZXIsIGVuZFk6IG51bWJlcik6IFJlY3Qge1xyXG4gICAgbGV0IFt3LCBoXSA9IFtlbmRYIC0gc3RhcnRYLCBlbmRZIC0gc3RhcnRZXVxyXG5cclxuICAgIGxldCBsZWZ0ID0gdyA8IDAgPyBzdGFydFggLSBNYXRoLmFicyh3KTogIHN0YXJ0WFxyXG4gICAgbGV0IHRvcCA9IGggPCAwID8gc3RhcnRZIC0gTWF0aC5hYnMoaCk6IHN0YXJ0WVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGxlZnQ6IGxlZnQsXHJcbiAgICAgIHRvcDogdG9wLFxyXG4gICAgICB3aWR0aDogTWF0aC5hYnModyksXHJcbiAgICAgIGhlaWdodDogTWF0aC5hYnMoaClcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGlzT25DYW52YXMocGFnZVg6IG51bWJlciwgcGFnZVk6IG51bWJlcik6IGJvb2xlYW4ge1xyXG4gICAgaWYgKFxyXG4gICAgICBwYWdlWCA8IHRoaXMuaW1nLm9mZnNldExlZnQgfHxcclxuICAgICAgcGFnZVggPiAodGhpcy5pbWcub2Zmc2V0TGVmdCArIHRoaXMuaW1nLndpZHRoKSB8fFxyXG4gICAgICBwYWdlWSA8IHRoaXMuaW1nLm9mZnNldFRvcCB8fFxyXG4gICAgICBwYWdlWSA+ICh0aGlzLmltZy5vZmZzZXRUb3AgKyB0aGlzLmltZy5oZWlnaHQpXHJcbiAgICApIHsgcmV0dXJuIGZhbHNlfVxyXG5cclxuICAgIHJldHVybiB0cnVlXHJcbiAgfVxyXG5cclxuICBzZXRNYXhXaWR0aCh3aWR0aDogbnVtYmVyKSB7XHJcbiAgICB0aGlzLm1heFdpZHRoID0gd2lkdGhcclxuICB9XHJcblxyXG4gIHNldENvbG9yKGNvbG9yOiBzdHJpbmcpIHtcclxuICAgIHRoaXMuY29sb3IgPSBjb2xvclxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogc2V0IHRvb2wgYXMgbW91c2UgdHlwZVxyXG4gICAqIEBwYXJhbSB0b29sIE1vdXNlVHlwZVxyXG4gICAqL1xyXG4gIHNldFRvb2wodG9vbDogTW91c2VUeXBlKSB7XHJcbiAgICB0aGlzLm1vdXNlVHlwZSA9IHRvb2xcclxuXHJcbiAgICBpZiAodG9vbCA9PT0gTW91c2VUeXBlLkdSQUZGSVRJKSB7XHJcbiAgICAgIHRoaXMuc2V0R3JhZmZpdGkoKVxyXG4gICAgfSBlbHNlIGlmICh0b29sID09PSBNb3VzZVR5cGUuRVJBU0VSKSB7XHJcbiAgICAgIHRoaXMuc2V0RXJhc2VyKClcclxuICAgIH0gZWxzZSBpZiAodG9vbCA9IE1vdXNlVHlwZS5NT1NBSUMpIHtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEdyYWZmaXRpKCkge1xyXG4gICAgaWYgKHRoaXMubW91c2UpIHtcclxuICAgICAgKE9iamVjdCBhcyBhbnkpLmFzc2lnbih0aGlzLm1vdXNlLnN0eWxlLCB7XHJcbiAgICAgICAgYm9yZGVyUmFkaXVzOiAnMTAwJScsXHJcbiAgICAgICAgYm9yZGVyOiBgMXB4IHNvbGlkICR7UGhvdG9Db3Zlci5ERUZBVUxUX0dSQUZGSVRJX0JPUkRFUl9DT0xPUn1gXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5tb3VzZVR5cGUgPSBNb3VzZVR5cGUuR1JBRkZJVElcclxuICB9XHJcblxyXG4gIHNldEVyYXNlcigpIHtcclxuICAgIGlmICh0aGlzLm1vdXNlKSB7XHJcbiAgICAgIChPYmplY3QgYXMgYW55KS5hc3NpZ24odGhpcy5tb3VzZS5zdHlsZSwge1xyXG4gICAgICAgIGJvcmRlclJhZGl1czogJzEwMCUnLFxyXG4gICAgICAgIGJvcmRlcjogYDFweCBkYXNoZWQgJHtQaG90b0NvdmVyLkRFRkFVTFRfRVJBU0VSX0JPUkRFUl9DT0xPUn1gXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5tb3VzZVR5cGUgPSBNb3VzZVR5cGUuRVJBU0VSXHJcbiAgfVxyXG5cclxuICBzZXRNb3NhaWMoKSB7XHJcbiAgICB0aGlzLm1vdXNlVHlwZSA9IE1vdXNlVHlwZS5NT1NBSUNcclxuICB9XHJcblxyXG4gIHVuZG8oKSB7XHJcbiAgICBsZXQgY3R4ID0gdGhpcy5jdHhcclxuICAgIGxldCBjb2xvciA9IHRoaXMuY29sb3JcclxuXHJcbiAgICBjdHguc2F2ZSgpXHJcblxyXG4gICAgLy8gY3R4LmNsZWFyUmVjdCgwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KVxyXG4gICAgY3R4LmRyYXdJbWFnZSh0aGlzLmltZywgMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodClcclxuICAgIHRoaXMuaGlzdG9yaWVzLnBvcCgpXHJcbiAgICB0aGlzLmltZy5kaXNwYXRjaEV2ZW50KHRoaXMuaGlzdG9yeUNoYW5nZSlcclxuXHJcbiAgICB0aGlzLmhpc3Rvcmllcy5tYXAoKHN0ZXBzOiBBcnJheTxhbnk+KSA9PiB7XHJcbiAgICAgIHN0ZXBzLm1hcCgoc3RlcDogQXJyYXk8YW55PikgPT4ge1xyXG4gICAgICAgIGlmIChzdGVwWzBdID09PSBNb3VzZVR5cGUuR1JBRkZJVEkpIHtcclxuICAgICAgICAgIHRoaXMuY29sb3IgPSBzdGVwWzFdXHJcbiAgICAgICAgICB0aGlzLnNldFJhZGl1cyhzdGVwWzRdKVxyXG4gICAgICAgICAgdGhpcy5kcmF3TGluZShzdGVwWzJdLCBzdGVwWzNdKVxyXG4gICAgICAgIH0gZWxzZSBpZiAoc3RlcFswXSA9PT0gTW91c2VUeXBlLkVSQVNFUikge1xyXG4gICAgICAgICAgdGhpcy5zZXRSYWRpdXMoc3RlcFszXSlcclxuICAgICAgICAgIHRoaXMuZXJhc2Uoc3RlcFsxXSwgc3RlcFsyXSlcclxuICAgICAgICAgIHRoaXMuY29tYmluZVdpdGhCYWNrZ3JvdW5kKClcclxuICAgICAgICB9IGVsc2UgaWYgKHN0ZXBbMF0gPT09ICdNT1ZFX1RPJykge1xyXG4gICAgICAgICAgY3R4LmJlZ2luUGF0aCgpXHJcbiAgICAgICAgICBjdHgubW92ZVRvLmFwcGx5KGN0eCwgc3RlcC5zbGljZSgxKSlcclxuICAgICAgICB9IGVsc2UgaWYgKHN0ZXBbMF0gPT09IE1vdXNlVHlwZS5NT1NBSUMpIHtcclxuICAgICAgICAgIGxldCBpbWFnZURhdGEgPSB0aGlzLmN0eC5nZXRJbWFnZURhdGEoc3RlcFsxXSwgc3RlcFsyXSwgc3RlcFszXSwgc3RlcFs0XSlcclxuICAgICAgICAgIHRoaXMuY3R4LnB1dEltYWdlRGF0YSh0aGlzLm1vc2FpYyhpbWFnZURhdGEpLCBzdGVwWzFdLCBzdGVwWzJdLCAwLCAwLCBzdGVwWzNdLCBzdGVwWzRdKVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH0pXHJcblxyXG4gICAgdGhpcy5jb2xvciA9IGNvbG9yXHJcbiAgICBjdHgucmVzdG9yZSgpXHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogZ2V0IGltYWdlIG9yaWdpbiBzaXplXHJcbiAgICogQHBhcmFtICB7U3RyaW5nfSAgIHNyYyAgICAgIGlhbWdlIHNvdXJjZSB1cmxcclxuICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2FsbGJhY2sgY2FsbGJhY2sgZnVuY3Rpb24sIHdpZHRoIGFzIGZpcnN0IHBhcmFtZXRlciBhbmQgaGVpZ2h0IGFzIHNlY29uZFxyXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZH1cclxuICAgKi9cclxuICBnZXRJbWFnZU9yaWdpblNpemUoc3JjOiBzdHJpbmcsIGNhbGxiYWNrPzogRnVuY3Rpb24pIHtcclxuICAgIGxldCBpbWcgPSBuZXcgSW1hZ2UoKVxyXG5cclxuICAgIGltZy5vbmxvYWQgPSAoKSA9PiB7XHJcbiAgICAgIGxldCB3aWR0aCA9IGltZy53aWR0aFxyXG4gICAgICBsZXQgaGVpZ2h0ID0gaW1nLmhlaWdodFxyXG5cclxuICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2sod2lkdGgsIGhlaWdodClcclxuICAgIH1cclxuXHJcbiAgICBpbWcuc3JjID0gc3JjXHJcbiAgfVxyXG5cclxuICBnZXREYXRhVVJMKHR5cGUgPSAnaW1hZ2UvanBlZycsIHF1YWxpdHkgPSAwLjgsIGNhbGxiYWNrPzogRnVuY3Rpb24pIHtcclxuICAgIHRoaXMuY29tYmluZVdpdGhCYWNrZ3JvdW5kKChjYW52YXM6IGFueSkgPT4ge1xyXG4gICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhjYW52YXMudG9EYXRhVVJMKHR5cGUsIHF1YWxpdHkpKVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBsZXQgc3JjID0gdGhpcy5pbWcuc3JjXHJcblxyXG4gICAgLy8gdGhpcy5nZXRJbWFnZU9yaWdpblNpemUoc3JjLCAod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpID0+IHtcclxuICAgIC8vICAgbGV0IHRlbXBDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKVxyXG4gICAgLy8gICB0ZW1wQ2FudmFzLndpZHRoID0gd2lkdGhcclxuICAgIC8vICAgdGVtcENhbnZhcy5oZWlnaHQgPSBoZWlnaHRcclxuICAgIC8vICAgbGV0IHRlbXBDdHggPSB0ZW1wQ2FudmFzLmdldENvbnRleHQoJzJkJylcclxuICAgIC8vICAgaWYgKHRlbXBDdHgpIHtcclxuICAgIC8vICAgICB0ZW1wQ3R4LmRyYXdJbWFnZSh0aGlzLmltZywgMCwgMCwgd2lkdGgsIGhlaWdodClcclxuICAgIC8vICAgICB0ZW1wQ3R4LmRyYXdJbWFnZSh0aGlzLmNhbnZhcywgMCwgMCwgd2lkdGgsIGhlaWdodClcclxuXHJcbiAgICAvLyAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2sodGVtcENhbnZhcy50b0RhdGFVUkwodHlwZSwgcXVhbGl0eSkpXHJcbiAgICAvLyAgIH1cclxuICAgIC8vIH0pXHJcbiAgfVxyXG5cclxuXHJcbiAgY29tYmluZVdpdGhCYWNrZ3JvdW5kKGNhbGxiYWNrPzogRnVuY3Rpb24pIHtcclxuICAgIGNvbnN0IGRvYyA9IHRoaXMuZG9jXHJcbiAgICBsZXQgY2FudmFzID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpXHJcbiAgICBjYW52YXMud2lkdGggPSB0aGlzLmNhbnZhcy53aWR0aFxyXG4gICAgY2FudmFzLmhlaWdodCA9IHRoaXMuY2FudmFzLmhlaWdodFxyXG5cclxuICAgIGxldCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKVxyXG5cclxuICAgIGlmICghY3R4KSB7IHJldHVybiB9XHJcblxyXG4gICAgY3R4LmRyYXdJbWFnZSh0aGlzLmltZywgMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KVxyXG4gICAgY3R4LmRyYXdJbWFnZSh0aGlzLmNhbnZhcywgMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KVxyXG5cclxuICAgIHRoaXMuY3R4LmRyYXdJbWFnZShjYW52YXMsIDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpXHJcbiAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhjYW52YXMsIGN0eClcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHJlbW92ZSBkb20gdGhhdCBhZGRlZCBpbnRvIGJvZHksXHJcbiAgICogcmVtb3ZlIGFsbCBldmVudHMgdGhhdCByZWdpc3RlcmVkXHJcbiAgICovXHJcbiAgZGVzdHJveSgpIHtcclxuICAgIHRoaXMuY2FudmFzLnBhcmVudE5vZGUgJiYgdGhpcy5jYW52YXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmNhbnZhcylcclxuICAgIHRoaXMubW91c2UucGFyZW50Tm9kZSAmJiB0aGlzLm1vdXNlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5tb3VzZSlcclxuXHJcbiAgICB0aGlzLmltZy5zcmMgPSAnJ1xyXG5cclxuICAgIHRoaXMuYmluZGVkRXZlbnRzLmZvckVhY2godiA9PiB7XHJcbiAgICAgIHZbMF0ucmVtb3ZlRXZlbnRMaXN0ZW5lcih2WzFdLCB2WzJdLCBmYWxzZSlcclxuICAgIH0pXHJcbiAgICAvLyBkZWxldGUgdGhpc1xyXG4gIH1cclxufVxyXG4iXX0=
